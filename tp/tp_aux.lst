     1                                  global	main
     2                                  extern 	printf
     3                                  extern  gets
     4                                  
     5                                  extern  system
     6                                  
     7                                  section .data
     8 00000000 496E6772657365204F-         msjIngFilaColumnaOrigen	db	'Ingrese Origen [XY]: ',0
     8 00000009 726967656E205B5859-
     8 00000012 5D3A2000           
     9 00000016 496E67726573652044-         msjIngFilaColumnaDestino	db	'Ingrese Destino [XY]: ',0
     9 0000001F 657374696E6F205B58-
     9 00000028 595D3A2000         
    10                                  
    11 0000002D 0A00                        saltoLinea  db 10, 0     ; Salto de l√≠nea al final de cada fila     
    12 0000002F 00                          posicion    db       0
    13 00000030 256C6900                    format	db	'%li', 0
    14                                  
    15                                      longitudElemento equ	1
    16                                      cantidadColumnas equ 8
    17                                      cantidadFilas    equ	9
    18                                      
    19 00000034 01                          posx_ini db 1
    20 00000035 01                          posy_ini db 1
    21                                      
    22 00000036 01                          posx_fin db 1
    23 00000037 01                          posy_fin db 1
    24                                      
    25 00000038 01                          elemento_inicial db 1
    26                                  
    27 00000039 256C6920256C6900            format2	db	'%li %li', 0
    28 00000041 636C65617200                cmd_clear db "clear",0
    29                                      
    30 00000047 4573207475726E6F20-         esTurnoDe	db	'Es turno de los %s!',10,0
    30 00000050 6465206C6F73202573-
    30 00000059 210A00             
    31 0000005C 6F66696369616C6573-         oficiales   db 'oficiales',0
    31 00000065 00                 
    32 00000066 736F6C6461646F7300          soldados    db 'soldados',0
    33 0000006F 736F6C6461646F7300          jugadorActual db 'soldados',0
    34 00000078 636173696C6C65726F-         casilleroInvalido db 'casillero invalido!',10,0
    34 00000081 20696E76616C69646F-
    34 0000008A 210A00             
    35 0000008D 6D6F76696D69656E74-         msj_movimiento_oficial_invalido db 'movimiento_oficial_invalido! Vuelva a intentarlo',10,0
    35 00000096 6F5F6F66696369616C-
    35 0000009F 5F696E76616C69646F-
    35 000000A8 21205675656C766120-
    35 000000B1 6120696E74656E7461-
    35 000000BA 726C6F0A00         
    36 000000BF 6D6F76696D69656E74-         msj_movimiento_soldado_invalido db 'movimiento_soldado_invalido! Vuelva a intentarlo',10,0
    36 000000C8 6F5F736F6C6461646F-
    36 000000D1 5F696E76616C69646F-
    36 000000DA 21205675656C766120-
    36 000000E3 6120696E74656E7461-
    36 000000EC 726C6F0A00         
    37                                  
    38 000000F1 47616E61726F6E206C-         msj_ganaron_soldados_por_falta_oficiales db 'Ganaron los soldados, no hay mas oficiales que puedan defender la fortaleza!',10,0
    38 000000FA 6F7320736F6C646164-
    38 00000103 6F732C206E6F206861-
    38 0000010C 79206D6173206F6669-
    38 00000115 6369616C6573207175-
    38 0000011E 652070756564616E20-
    38 00000127 646566656E64657220-
    38 00000130 6C6120666F7274616C-
    38 00000139 657A61210A00       
    39 0000013F 47616E61726F6E206C-         msj_ganaron_soldados_por_invasion db 'Ganaron los soldados, invadieron la fortaleza!',10,0
    39 00000148 6F7320736F6C646164-
    39 00000151 6F732C20696E766164-
    39 0000015A 6965726F6E206C6120-
    39 00000163 666F7274616C657A61-
    39 0000016C 210A00             
    40 0000016F 47616E61726F6E206C-         msj_ganaron_oficiales_por_falta_soldados db 'Ganaron los oficiales, ya no quedan mas soldados!',10,0
    40 00000178 6F73206F6669636961-
    40 00000181 6C65732C207961206E-
    40 0000018A 6F2071756564616E20-
    40 00000193 6D617320736F6C6461-
    40 0000019C 646F73210A00       
    41                                  
    42 000001A2 46696E2064656C206A-         endGame    db 'Fin del juego!',10,0
    42 000001AB 7565676F210A00     
    43 000001B2 01                          turno db 1
    44 000001B3 02                          divisor db 2 
    45                                      
    46 000001B4 7E3132333435363700          matriz  db '~1234567',0
    47 000001BD 317E7C5858587C7E00                  db '1~|XXX|~',0
    48 000001C6 327E7C5858587C7E00                  db '2~|XXX|~',0
    49 000001CF 335858585858585800                  db '3XXXXXXX',0
    50 000001D8 345858205858585800                  db '4XX XXXX',0
    51 000001E1 355858205820585800                  db '5XX X XX',0
    52 000001EA 367E7C20204F7C7E00                  db '6~|  O|~',0
    53 000001F3 377E7C4F20207C7E00                  db '7~|O  |~',0
    54 000001FC 2D2D2D2D2D2D2D2D00                  db '--------',0
    55                                  
    56                                  section .bss    
    57 00000000 <res Ah>                    buffer		resb	10
    58 0000000A ????                        cadena resb 2
    59 0000000C ??                          numero  resb 1
    60                                  
    61                                  section .text
    62                                  main:
    63 00000000 4889E5                      mov rbp, rsp; for correct debugging
    64 00000003 4883EC08                    sub rsp, 8
    65 00000007 41BE02000000                mov r14, 2 ;seteo cantidad de oficiales.
    66 0000000D E886040000                  call asignar_jugador_inicial
    67                                  ciclo_juego:
    68 00000012 E826030000                  call clear_screen
    69 00000017 E818020000                  call mostrar_tablero
    70 0000001C E8FA030000                  call mostrar_jugador_actual
    71                                  pedir_movimiento:
    72 00000021 E82F030000                  call pedir_casillero_origen
    73                                  pedir_movimiento_destino:
    74 00000026 E894030000                  call pedir_casillero_destino
    75                                  
    76 0000002B 8A0425[B2010000]            mov al, [turno]
    77 00000032 3C01                        cmp al, 1
    78 00000034 7410                        je validar_movimiento_soldado
    79 00000036 E832060000                  call validar_movimiento_oficial ;hacer esto solo si es el turno del oficial.
    80 0000003B 4983FC00                    cmp r12, 0                  ; Si la validacion esta mal -> r12 != 0 -> volver a pedir origen-destin0
    81 0000003F 75E0                        jne pedir_movimiento         ; Si no es 0 -> back to pedir_movimiento
    82 00000041 E9BC010000                  jmp prox_turno
    83                                  
    84                                  validar_movimiento_soldado:
    85 00000046 B800000000                  mov rax,0
    86                                      
    87 0000004B 8A0425[36000000]            mov al, [posx_fin]
    88 00000052 8A2425[34000000]            mov ah, [posx_ini]
    89 00000059 28E0                        sub al, ah
    90                                  
    91 0000005B 3C00                        cmp al, 0
    92 0000005D 7415                        je validar_movimiento_soldado_horizontal
    93 0000005F 3CFF                        cmp al,-1 
    94 00000061 0F84D6000000                je validar_movimiento_soldado_arriba
    95 00000067 3C01                        cmp al, 1
    96 00000069 0F845C010000                je validar_movimiento_soldado_abajo
    97 0000006F E9BB070000                  jmp movimiento_soldado_invalido
    98                                      
    99                                  ;fn terminada
   100                                  validar_movimiento_soldado_horizontal:
   101 00000074 B800000000                  mov rax,0
   102 00000079 8A0425[34000000]            mov al, [posx_ini]
   103                                  
   104 00000080 3C07                        cmp al, 7
   105 00000082 740D                        je validar_movimiento_soldado_horizontal_fila_siete_seis
   106 00000084 3C06                        cmp al, 6
   107 00000086 7409                        je validar_movimiento_soldado_horizontal_fila_siete_seis
   108 00000088 3C05                        cmp al, 5
   109 0000008A 7451                        je validar_movimiento_soldado_horizontal_fila_cinco
   110                                  
   111 0000008C E99E070000                  jmp movimiento_soldado_invalido
   112                                  
   113                                  ;fn terminada
   114                                  validar_movimiento_soldado_horizontal_fila_siete_seis:
   115 00000091 BA00000000                  mov rdx,0
   116 00000096 8A1425[35000000]            mov dl, [posy_ini]
   117 0000009D 8A3425[37000000]            mov dh, [posy_fin]
   118                                  
   119 000000A4 80FA03                      cmp dl, 3
   120 000000A7 740F                        je validar_movimiento_soldado_horizontal_columna_tres_cinco
   121 000000A9 80FA04                      cmp dl, 4
   122 000000AC 7418                        je validar_movimiento_soldado_horizontal_columna_cuatro
   123 000000AE 80FA05                      cmp dl, 5
   124 000000B1 7405                        je validar_movimiento_soldado_horizontal_columna_tres_cinco
   125 000000B3 E977070000                  jmp movimiento_soldado_invalido
   126                                  
   127                                  validar_movimiento_soldado_horizontal_columna_tres_cinco:
   128 000000B8 80FE04                      cmp dh, 4
   129 000000BB 0F8493070000                je movimiento_soldado_valido
   130 000000C1 E969070000                  jmp movimiento_soldado_invalido
   131                                  
   132                                  validar_movimiento_soldado_horizontal_columna_cuatro:
   133 000000C6 80FE03                      cmp dh, 3
   134 000000C9 0F8485070000                je movimiento_soldado_valido
   135 000000CF 80FE05                      cmp dh, 5
   136 000000D2 0F847C070000                je movimiento_soldado_valido
   137 000000D8 E952070000                  jmp movimiento_soldado_invalido
   138                                  
   139                                  validar_movimiento_soldado_horizontal_fila_cinco:
   140 000000DD BA00000000                  mov rdx,0
   141 000000E2 8A1425[35000000]            mov dl, [posy_ini]
   142 000000E9 8A3425[37000000]            mov dh, [posy_fin]
   143                                      
   144 000000F0 80FA03                      cmp dl, 3
   145 000000F3 7E0F                        jle movimiento_soldado_derecha
   146 000000F5 80FA04                      cmp dl, 4
   147 000000F8 742A                        je movimiento_soldado_derecha_izquierda
   148 000000FA 80FA07                      cmp dl, 7
   149 000000FD 7E15                        jle movimiento_soldado_izquierda
   150 000000FF E92B070000                  jmp movimiento_soldado_invalido
   151                                  
   152                                  movimiento_soldado_derecha:
   153 00000104 28D6                        sub dh,dl
   154 00000106 80FE01                      cmp dh, 1
   155 00000109 0F8445070000                je movimiento_soldado_valido
   156 0000010F E91B070000                  jmp movimiento_soldado_invalido
   157                                  
   158                                  movimiento_soldado_izquierda:
   159 00000114 28D6                        sub dh,dl
   160 00000116 80FEFF                      cmp dh,-1
   161 00000119 0F8435070000                je movimiento_soldado_valido
   162 0000011F E90B070000                  jmp movimiento_soldado_invalido
   163                                  
   164                                  movimiento_soldado_derecha_izquierda:
   165 00000124 28D6                        sub dh,dl
   166 00000126 80FEFF                      cmp dh,-1
   167 00000129 0F8425070000                je movimiento_soldado_valido
   168 0000012F 80FE01                      cmp dh, 1
   169 00000132 0F841C070000                je movimiento_soldado_valido
   170 00000138 E9F2060000                  jmp movimiento_soldado_invalido
   171                                  
   172                                  ;;fin validar movimientos horizontales
   173                                  validar_movimiento_soldado_arriba:
   174 0000013D B800000000                  mov rax,0
   175 00000142 8A0425[34000000]            mov al, [posx_ini]
   176                                      
   177 00000149 3C06                        cmp al, 6
   178 0000014B 7409                        je validar_movimiento_soldado_arriba_en_fortaleza
   179 0000014D 3C07                        cmp al, 7
   180 0000014F 7405                        je validar_movimiento_soldado_arriba_en_fortaleza
   181 00000151 E9D9060000                  jmp movimiento_soldado_invalido
   182                                  
   183                                  validar_movimiento_soldado_arriba_en_fortaleza:
   184 00000156 BA00000000                  mov rdx,0
   185 0000015B 8A1425[35000000]            mov dl, [posy_ini]
   186 00000162 8A3425[37000000]            mov dh, [posy_fin]
   187                                  
   188 00000169 80FA03                      cmp dl, 3
   189 0000016C 740F                        je validar_movimiento_soldado_arriba_en_fortaleza_columna_tres
   190 0000016E 80FA04                      cmp dl, 4
   191 00000171 7421                        je validar_movimiento_soldado_arriba_en_fortaleza_columna_cuatro
   192 00000173 80FA05                      cmp dl, 5
   193 00000176 743C                        je validar_movimiento_soldado_arriba_en_fortaleza_columna_cinco
   194 00000178 E9B2060000                  jmp movimiento_soldado_invalido
   195                                  
   196                                  validar_movimiento_soldado_arriba_en_fortaleza_columna_tres:
   197 0000017D 80FE03                      cmp dh, 3
   198 00000180 0F84CE060000                je movimiento_soldado_valido
   199 00000186 80FE04                      cmp dh, 4
   200 00000189 0F84C5060000                je movimiento_soldado_valido
   201 0000018F E99B060000                  jmp movimiento_soldado_invalido
   202                                  
   203                                  validar_movimiento_soldado_arriba_en_fortaleza_columna_cuatro:
   204 00000194 80FE03                      cmp dh, 3
   205 00000197 0F84B7060000                je movimiento_soldado_valido
   206 0000019D 80FE04                      cmp dh, 4
   207 000001A0 0F84AE060000                je movimiento_soldado_valido
   208 000001A6 80FE05                      cmp dh, 5
   209 000001A9 0F84A5060000                je movimiento_soldado_valido
   210 000001AF E97B060000                  jmp movimiento_soldado_invalido
   211                                  
   212                                  validar_movimiento_soldado_arriba_en_fortaleza_columna_cinco:
   213 000001B4 80FE04                      cmp dh, 4
   214 000001B7 0F8497060000                je movimiento_soldado_valido
   215 000001BD 80FE05                      cmp dh, 5
   216 000001C0 0F848E060000                je movimiento_soldado_valido
   217 000001C6 E964060000                  jmp movimiento_soldado_invalido
   218                                  
   219                                  validar_movimiento_soldado_abajo:
   220 000001CB BA00000000                  mov rdx,0
   221 000001D0 8A1425[35000000]            mov dl, [posy_ini]
   222 000001D7 8A3425[37000000]            mov dh, [posy_fin]
   223                                      
   224 000001DE 28D6                        sub dh, dl
   225 000001E0 80FEFF                      cmp dh,-1
   226 000001E3 0F846B060000                je movimiento_soldado_valido
   227 000001E9 80FE00                      cmp dh, 0
   228 000001EC 0F8462060000                je movimiento_soldado_valido
   229 000001F2 80FE01                      cmp dh, 1
   230 000001F5 0F8459060000                je movimiento_soldado_valido
   231 000001FB E92F060000                  jmp movimiento_soldado_invalido
   232                                  
   233                                  ;;fin validar_movimiento_soldado
   234 00000200 EB00                        jmp prox_turno
   235                                      
   236                                  prox_turno:
   237 00000202 E834020000                  call actualizar_turno
   238 00000207 E899000000                  call actualizar_tablero
   239 0000020C E83D070000                  call verificar_ganador
   240 00000211 E9FCFDFFFF                  jmp ciclo_juego      ; Repite el bucle
   241                                          
   242                                      fin:
   243                                  ;    add rsp, 8             ; Restaura el espacio de la pila
   244                                      ;call clear_screen
   245                                  
   246 00000216 48BF-                       mov rdi, endGame
   246 00000218 [A201000000000000] 
   247 00000220 4883EC08                    sub rsp, 8
   248 00000224 E8(00000000)                call printf
   249 00000229 4883C408                    add rsp,8
   250                                  
   251 0000022D B44C                        mov ah, 4Ch    ; C√≥digo de funci√≥n para terminar el programa;    mov al, 0      ; C√≥digo de retorno (0 indica √©xito)
   252 0000022F B000                        mov al, 0      ; C√≥digo de retorno (0 indica √©xito)
   253 00000231 CD21                        int 21h        ; Llamada a la interrupci√≥n 21h
   254                                  
   255 00000233 C3                          ret
   256                                  
   257                                  mostrar_tablero:
   258 00000234 B800000000                  mov rax, 0
   259 00000239 48890425[2F000000]          mov [posicion], rax 
   260 00000241 B908000000                  mov rcx, cantidadColumnas
   261 00000246 4883EC08                    sub rsp, 8
   262                                      fila_loop:
   263 0000024A 51                              push rcx ;es necesario para loop, sino el registro rcx se pisa y loopea infinito
   264                                          ; Carga la direcci√≥n de la fila actual en la matriz
   265                                  
   266                                          ; Imprime la fila actual
   267                                  
   268 0000024B 48BF-                           mov rdi, matriz         ; Pasa la direcci√≥n de la fila a printf
   268 0000024D [B401000000000000] 
   269 00000255 48033C25[2F000000]              add rdi, [posicion]
   270 0000025D 4829C0                          sub rax, rax           ; Limpia rax para printf
   271                                          
   272                                          
   273 00000260 E8(00000000)                    call printf
   274                                          ; Imprime salto de l√≠nea despu√©s de cada fila
   275 00000265 48BF-                           mov rdi, saltoLinea
   275 00000267 [2D00000000000000] 
   276 0000026F 4831C0                          xor rax, rax           ; Limpia rax para printf
   277 00000272 E8(00000000)                    call printf
   278 00000277 59                              pop rcx ;es necesario para loop, sino el registro rcx se pisa y loopea infinito
   279                                          
   280                                          ; Sumar 10 a "posicion"
   281 00000278 488B0425[2F000000]              mov rax, [posicion]         ; Carga el valor de "posicion" en rax
   282 00000280 4883C009                        add rax, cantidadFilas                 ; Suma 10 a rax
   283 00000284 48890425[2F000000]              mov [posicion], rax         ; Guarda el nuevo valor en "posicion"
   284                                          
   285 0000028C E2BC                            loop fila_loop
   286                                          
   287 0000028E 48BF-                           mov rdi, saltoLinea
   287 00000290 [2D00000000000000] 
   288 00000298 4831C0                          xor rax, rax           ; Limpia rax para printf
   289 0000029B E8(00000000)                    call printf
   290 000002A0 4883C408                        add rsp, 8
   291 000002A4 C3                              ret
   292                                  
   293                                  actualizar_tablero:
   294                                      ;Posicionamiento en el elemento i,j de una matriz
   295                                      ;(i-1)*longitudFila + (j-1)*longitudElemento
   296                                      ;longitdFila= longitudElemento*cantidadColumnas
   297 000002A5 4829C9                      sub rcx, rcx
   298 000002A8 4829C0                      sub rax, rax
   299 000002AB 4829DB                      sub rbx, rbx
   300 000002AE 4D29D2                      sub r10, r10
   301 000002B1 8A0425[34000000]            mov al,[posx_ini] ;guardo el valor de la fila, en AL(8bits) 
   302                                                      ;ya que posx es db (byte= 8bits) sino guarda cualquier cosa
   303                                  ;    sub rax,1 -> no es necesaria la resta ya que la matriz empieza en 1,1
   304 000002B8 41B809000000                mov r8, cantidadFilas
   305 000002BE 49F7E8                      imul r8   ;me desplazo en la fila
   306 000002C1 4801C1                      add rcx,rax
   307                                      
   308 000002C4 8A0425[35000000]            mov al,[posy_ini] ;guardo el valor de la col,
   309                                  ;    sub rax,1
   310 000002CB 41B801000000                mov r8, longitudElemento ;guardo en r8 para darle longitud y poder multiplicar usando imul
   311 000002D1 49F7E8                      imul r8 ;me desplazo en la columna
   312 000002D4 4801C1                      add rcx,rax ;sumo los desplazamientos
   313                                      
   314                                      
   315 000002D7 48BB-                       mov rbx,matriz ;pongo el pto al inicio de la matriz
   315 000002D9 [B401000000000000] 
   316 000002E1 4801CB                      add rbx,rcx ;me posicione en la matriz
   317                                  
   318 000002E4 4C8B13                      mov r10, [rbx] ;guardo un elemento
   319 000002E7 4C8B4B01                    mov r9, [rbx+1] ;guardo en r9 lo que le sigue de matriz posterior al elemento a actualizar
   320 000002EB 41B820000000                mov r8, " " ; lo muevo a un reg para darle (y estar seguro de su) longitud
   321 000002F1 4C8903                      mov [rbx],r8 ;muevo el valor(de igual longitud). muevo a la posicion de la matriz a actualizar
   322                                      
   323                                      ;despues de agregar el nuevo valor, agregarle el resto de la matriz que estaba antes.
   324 000002F4 4C894B01                    mov [rbx+1],r9
   325                                      
   326                                      
   327                                      ;;repito con casillero_destino
   328                                      ;;y guardo en el destino lo que guarde en r10 (el elemento origen)
   329                                      
   330                                      
   331                                      ;Posicionamiento en el elemento i,j de una matriz
   332                                      ;(i-1)*longitudFila + (j-1)*longitudElemento
   333                                      ;longitdFila= longitudElemento*cantidadColumnas
   334 000002F8 4829C9                      sub rcx, rcx
   335 000002FB 8A0425[36000000]            mov al,[posx_fin] ;guardo el valor de la fila, en AL(8bits) 
   336                                                      ;ya que posx es db (byte= 8bits) sino guarda cualquier cosa
   337                                  ;    sub rax,1 -> no es necesaria la resta ya que la matriz empieza en 1,1
   338 00000302 41B809000000                mov r8, cantidadFilas
   339 00000308 49F7E8                      imul r8   ;me desplazo en la fila
   340 0000030B 4801C1                      add rcx,rax
   341                                      
   342 0000030E 8A0425[37000000]            mov al,[posy_fin] ;guardo el valor de la col,
   343                                  ;    sub rax,1
   344 00000315 41B801000000                mov r8, longitudElemento ;guardo en r8 para darle longitud y poder multiplicar usando imul
   345 0000031B 49F7E8                      imul r8 ;me desplazo en la columna
   346 0000031E 4801C1                      add rcx,rax ;sumo los desplazamientos
   347                                      
   348                                      
   349 00000321 48BB-                       mov rbx,matriz ;pongo el pto al inicio de la matriz
   349 00000323 [B401000000000000] 
   350 0000032B 4801CB                      add rbx,rcx ;me posicione en la matriz
   351                                  
   352 0000032E 4C8B4B01                    mov r9, [rbx+1] ;guardo en r9 lo que le sigue de matriz posterior al elemento a actualizar
   353 00000332 4D89D0                      mov r8, r10 ; lo muevo a un reg para darle (y estar seguro de su) longitud
   354 00000335 4C8903                      mov [rbx],r8 ;muevo el valor(de igual longitud). muevo a la posicion de la matriz a actualizar
   355                                      
   356                                      ;despues de agregar el nuevo valor, agregarle el resto de la matriz que estaba antes.
   357 00000338 4C894B01                    mov [rbx+1],r9
   358                                  
   359 0000033C C3                          ret
   360                                  
   361                                  clear_screen:
   362                                  
   363 0000033D 48BF-                       mov rdi, cmd_clear
   363 0000033F [4100000000000000] 
   364 00000347 4883EC08                    sub rsp, 8
   365 0000034B E8(00000000)                call system
   366 00000350 4883C408                    add rsp, 8
   367 00000354 C3                          ret
   368                                      
   369                                  pedir_casillero_origen:
   370                                      
   371 00000355 4889E0                      mov rax, rsp
   372 00000358 4883E00F                    and rax, 15
   373 0000035C 7404                        je no_restar_rsp_1
   374 0000035E 4883EC08                    sub rsp, 8
   375                                  no_restar_rsp_1:
   376 00000362 48BF-                       mov rdi, msjIngFilaColumnaOrigen
   376 00000364 [0000000000000000] 
   377 0000036C E8(00000000)                call printf
   378                                  
   379 00000371 48BF-                       mov rdi, cadena      ; Direcci√≥n de 'cadena'
   379 00000373 [0A00000000000000] 
   380 0000037B E8(00000000)                call gets
   381 00000380 4883C408                    add rsp, 8
   382                                  
   383                                      ; Extraer el primer car√°cter (primer n√∫mero)
   384 00000384 480FB60425-                 movzx rax, byte [cadena]     ; Cargar el primer car√°cter de 'cadena' en rax
   384 00000389 [0A000000]         
   385 0000038D 4883E830                    sub rax, '0'                 ; Convertir de ASCII a valor num√©rico
   386 00000391 880425[34000000]            mov [posx_ini], al            ; Guardar el valor en 'posx_ini'
   387                                      
   388 00000398 803C25[34000000]00          cmp byte [posx_ini], 0
   389 000003A0 0F8470FEFFFF                je fin               ; Si es 0, salta a "fin de juego"
   390                                      
   391                                      ; Extraer el segundo car√°cter (segundo n√∫mero)
   392 000003A6 480FB60425-                 movzx rax, byte [cadena + 1] ; Cargar el segundo car√°cter de 'cadena' en rax
   392 000003AB [0B000000]         
   393 000003AF 4883E830                    sub rax, '0'                 ; Convertir de ASCII a valor num√©rico
   394 000003B3 880425[35000000]            mov [posy_ini], al            ; Guardar el valor en 'posy_ini'
   395                                      
   396 000003BA E9EA000000                  jmp validar_casillero_origen
   397                                      
   398                                  pedir_casillero_destino:
   399 000003BF 4883EC08                    sub rsp, 8
   400 000003C3 48BF-                       mov rdi, msjIngFilaColumnaDestino
   400 000003C5 [1600000000000000] 
   401 000003CD E8(00000000)                call printf
   402 000003D2 4883C408                    add rsp, 8
   403                                  
   404 000003D6 48BF-                       mov rdi, cadena      ; Direcci√≥n de 'cadena'
   404 000003D8 [0A00000000000000] 
   405 000003E0 4883EC08                    sub rsp, 8
   406 000003E4 E8(00000000)                call gets
   407 000003E9 4883C408                    add rsp, 8
   408                                  
   409                                      ; Extraer el primer car√°cter (primer n√∫mero)
   410 000003ED 480FB60425-                 movzx rax, byte [cadena]     ; Cargar el primer car√°cter de 'cadena' en rax
   410 000003F2 [0A000000]         
   411 000003F6 4883E830                    sub rax, '0'                 ; Convertir de ASCII a valor num√©rico
   412 000003FA 880425[36000000]            mov [posx_fin], al            ; Guardar el valor en 'posx_ini'
   413                                      
   414                                      ; Extraer el segundo car√°cter (segundo n√∫mero)
   415 00000401 480FB60425-                 movzx rax, byte [cadena + 1] ; Cargar el segundo car√°cter de 'cadena' en rax
   415 00000406 [0B000000]         
   416 0000040A 4883E830                    sub rax, '0'                 ; Convertir de ASCII a valor num√©rico
   417 0000040E 880425[37000000]            mov [posy_fin], al            ; Guardar el valor en 'posy_ini'
   418 00000415 E9B2010000                  jmp es_destino_valido
   419 0000041A C3                          ret
   420                                      
   421                                  mostrar_jugador_actual:    
   422 0000041B 4883EC08                    sub rsp, 8
   423 0000041F 48BF-                       mov rdi, esTurnoDe
   423 00000421 [4700000000000000] 
   424 00000429 488B3425[6F000000]          mov rsi, [jugadorActual]
   425                                   
   426 00000431 E8(00000000)                call printf
   427 00000436 4883C408                    add rsp, 8
   428 0000043A C3                          ret
   429                                      
   430                                  actualizar_turno:
   431 0000043B 8A0425[B2010000]            mov al, [turno]
   432 00000442 800425[B2010000]01          add byte [turno], 1
   433 0000044A 8A0425[B2010000]            mov al, [turno]
   434 00000451 30E4                        xor ah, ah        ; Limpiar AH para asegurar que AX est√° correcto
   435                                  
   436                                      ; Dividir AX entre el divisor (2)
   437 00000453 4831DB                      xor rbx, rbx        
   438 00000456 8A1C25[B3010000]            mov bl, [divisor]
   439 0000045D F6F3                        div bl            ; AX / BL -> AL = cociente, AH = resto
   440                                  
   441                                      ; Ahora, AH contiene el resto (turno % 2)
   442 0000045F 80FC00                      cmp ah, 0         ; Compara el resto con 0
   443 00000462 7402                        je es_par         ; Si el resto es 0, turno es par
   444 00000464 EB19                        jmp es_impar      ; Si no, turno es impar
   445                                  
   446                                  es_par:          
   447 00000466 C60425[B2010000]00          mov byte[turno], 0
   448 0000046E 488D0425[5C000000]          lea rax, [oficiales]          ; Cargar la direcci√≥n de 'soldados' en AX
   449 00000476 48890425[6F000000]          mov [jugadorActual], rax
   450 0000047E C3                          ret
   451                                  
   452                                  es_impar:        
   453 0000047F C60425[B2010000]01          mov byte[turno], 1
   454 00000487 488D0425[66000000]          lea rax, [soldados]          ; Cargar la direcci√≥n de 'soldados' en AX
   455 0000048F 48890425[6F000000]          mov [jugadorActual], rax
   456 00000497 C3                          ret
   457                                      
   458                                  asignar_jugador_inicial:
   459 00000498 488D0425[66000000]          lea rax, [soldados]          ; Cargar la direcci√≥n de 'soldados' en AX
   460 000004A0 48890425[6F000000]          mov [jugadorActual], rax
   461 000004A8 C3                          ret
   462                                      
   463                                  validar_casillero_origen:
   464                                      ;;valido que este dentro del tablero
   465 000004A9 4829C0                      sub rax, rax
   466 000004AC 4829DB                      sub rbx, rbx
   467 000004AF 8A0425[34000000]            mov al,[posx_ini]
   468 000004B6 8A1C25[35000000]            mov bl,[posy_ini]
   469                                      
   470                                      validar_dentro_x:
   471 000004BD 3C01                        cmp al, 1
   472 000004BF 740E                        je validar_dentro_y
   473 000004C1 3C02                        cmp al, 2
   474 000004C3 740A                        je validar_dentro_y
   475 000004C5 3C06                        cmp al, 6
   476 000004C7 7406                        je validar_dentro_y
   477 000004C9 3C07                        cmp al, 7
   478 000004CB 7402                        je validar_dentro_y
   479 000004CD EB16                        jmp dentro_tablero_origen_ok
   480                                  validar_dentro_y:
   481 000004CF 80FB01                      cmp bl, 1
   482 000004D2 7476                        je origen_invalido
   483 000004D4 80FB02                      cmp bl, 2
   484 000004D7 7471                        je origen_invalido
   485 000004D9 80FB06                      cmp bl, 6
   486 000004DC 746C                        je origen_invalido
   487 000004DE 80FB07                      cmp bl, 7
   488 000004E1 7467                        je origen_invalido
   489 000004E3 EB00                        jmp dentro_tablero_origen_ok
   490                                      
   491                                  dentro_tablero_origen_ok:
   492 000004E5 8A0425[B2010000]            mov al, [turno]
   493 000004EC 30E4                        xor ah, ah        ; Limpiar AH para asegurar que AX est√° correcto
   494                                  
   495                                      ; Dividir AX entre el divisor (2)
   496 000004EE 4831DB                      xor rbx, rbx        
   497 000004F1 8A1C25[B3010000]            mov bl, [divisor]
   498 000004F8 F6F3                        div bl            ; AX / BL -> AL = cociente, AH = resto
   499                                  
   500                                      ; Ahora, AH contiene el resto (turno % 2)
   501 000004FA 80FC00                      cmp ah, 0         ; Compara el resto con 0
   502 000004FD 7468                        je es_oficial_valido         ; Si el resto es 0, turno es par
   503 000004FF EB01                        jmp es_soldado_valido ; Si no, turno es impar
   504 00000501 C3                          ret
   505                                      
   506                                  es_soldado_valido:
   507                                  ;busco el elemento en la matriz; y lo guardo en r10 para comparar el elemento.
   508 00000502 4829C9                      sub rcx, rcx
   509 00000505 4829C0                      sub rax, rax
   510 00000508 4829DB                      sub rbx, rbx
   511 0000050B 4D29D2                      sub r10, r10
   512 0000050E 8A0425[34000000]            mov al,[posx_ini] 
   513 00000515 41B809000000                mov r8, cantidadFilas
   514 0000051B 49F7E8                      imul r8
   515 0000051E 4801C1                      add rcx,rax
   516                                      
   517 00000521 8A0425[35000000]            mov al,[posy_ini]
   518 00000528 41B801000000                mov r8, longitudElemento 
   519 0000052E 49F7E8                      imul r8
   520 00000531 4801C1                      add rcx,rax
   521                                      
   522 00000534 48BB-                       mov rbx,matriz 
   522 00000536 [B401000000000000] 
   523 0000053E 4801CB                      add rbx,rcx ;me posicione en la matriz
   524                                  
   525 00000541 4C8B13                      mov r10, [rbx] ;guardo un elemento
   526 00000544 4180FA58                    cmp r10b, 'X'
   527 00000548 741C                        je turno_soldado_ok
   528                                      ;sino fue un mal ingreso:
   529                                  origen_invalido:
   530 0000054A 48BF-                       mov rdi, casilleroInvalido
   530 0000054C [7800000000000000] 
   531 00000554 4883EC08                    sub rsp, 8
   532 00000558 E8(00000000)                call printf
   533 0000055D 4883C408                    add rsp, 8
   534 00000561 E9EFFDFFFF                  jmp pedir_casillero_origen
   535                                  turno_soldado_ok:
   536 00000566 C3                          ret
   537                                      
   538                                  es_oficial_valido:
   539                                  ;busco el elemento en la matriz; y lo guardo en r10 para comparar el elemento.
   540 00000567 4829C9                      sub rcx, rcx
   541 0000056A 4829C0                      sub rax, rax
   542 0000056D 4829DB                      sub rbx, rbx
   543 00000570 4D29D2                      sub r10, r10
   544 00000573 8A0425[34000000]            mov al,[posx_ini] 
   545 0000057A 41B809000000                mov r8, cantidadFilas
   546 00000580 49F7E8                      imul r8
   547 00000583 4801C1                      add rcx,rax
   548                                      
   549 00000586 8A0425[35000000]            mov al,[posy_ini]
   550 0000058D 41B801000000                mov r8, longitudElemento 
   551 00000593 49F7E8                      imul r8
   552 00000596 4801C1                      add rcx,rax
   553                                      
   554 00000599 48BB-                       mov rbx,matriz 
   554 0000059B [B401000000000000] 
   555 000005A3 4801CB                      add rbx,rcx ;me posicione en la matriz
   556                                  
   557 000005A6 4C8B13                      mov r10, [rbx] ;guardo un elemento
   558                                  ;;
   559 000005A9 4180FA4F                    cmp r10b, 'O'
   560 000005AD 741C                        je turno_oficial_ok
   561                                      ;sino fue un mal ingreso:
   562 000005AF 48BF-                       mov rdi, casilleroInvalido
   562 000005B1 [7800000000000000] 
   563 000005B9 4883EC08                    sub rsp, 8
   564 000005BD E8(00000000)                call printf
   565 000005C2 4883C408                    add rsp, 8
   566 000005C6 E98AFDFFFF                  jmp pedir_casillero_origen
   567                                      turno_oficial_ok:
   568 000005CB C3                          ret    
   569                                      
   570                                      
   571                                  es_destino_valido:
   572                                      ;;valido que este dentro del tablero
   573 000005CC 4829C0                      sub rax, rax
   574 000005CF 4829DB                      sub rbx, rbx
   575 000005D2 8A0425[36000000]            mov al,[posx_fin]
   576 000005D9 8A1C25[37000000]            mov bl,[posy_fin]
   577                                      
   578                                  validar_dentro_x_fin:
   579 000005E0 3C01                        cmp al, 1
   580 000005E2 740E                        je validar_dentro_y_fin
   581 000005E4 3C02                        cmp al, 2
   582 000005E6 740A                        je validar_dentro_y_fin
   583 000005E8 3C06                        cmp al, 6
   584 000005EA 7406                        je validar_dentro_y_fin
   585 000005EC 3C07                        cmp al, 7
   586 000005EE 7402                        je validar_dentro_y_fin
   587 000005F0 EB16                        jmp dentro_tablero_destino_ok
   588                                  validar_dentro_y_fin:
   589 000005F2 80FB01                      cmp bl, 1
   590 000005F5 7459                        je destino_invalido
   591 000005F7 80FB02                      cmp bl, 2
   592 000005FA 7454                        je destino_invalido
   593 000005FC 80FB06                      cmp bl, 6
   594 000005FF 744F                        je destino_invalido
   595 00000601 80FB07                      cmp bl, 7
   596 00000604 744A                        je destino_invalido
   597 00000606 EB00                        jmp dentro_tablero_destino_ok
   598                                      
   599                                  dentro_tablero_destino_ok:
   600                                  ;busco el elemento en la matriz; y lo guardo en r10 para comparar el elemento.
   601 00000608 4829C9                      sub rcx, rcx
   602 0000060B 4829C0                      sub rax, rax
   603 0000060E 4829DB                      sub rbx, rbx
   604 00000611 4D29D2                      sub r10, r10
   605 00000614 8A0425[36000000]            mov al,[posx_fin] 
   606 0000061B 41B809000000                mov r8, cantidadFilas
   607 00000621 49F7E8                      imul r8
   608 00000624 4801C1                      add rcx,rax
   609                                      
   610 00000627 8A0425[37000000]            mov al,[posy_fin]
   611 0000062E 41B801000000                mov r8, longitudElemento 
   612 00000634 49F7E8                      imul r8
   613 00000637 4801C1                      add rcx,rax
   614                                      
   615 0000063A 48BB-                       mov rbx,matriz 
   615 0000063C [B401000000000000] 
   616 00000644 4801CB                      add rbx,rcx ;me posicione en la matriz
   617                                  
   618 00000647 4C8B13                      mov r10, [rbx] ;guardo un elemento
   619                                  ;;
   620 0000064A 4180FA20                    cmp r10b, ' '
   621 0000064E 741C                        je destino_ok
   622                                      ;sino fue un mal ingreso:
   623                                  destino_invalido:
   624 00000650 48BF-                       mov rdi, casilleroInvalido
   624 00000652 [7800000000000000] 
   625 0000065A 4883EC08                    sub rsp, 8
   626 0000065E E8(00000000)                call printf
   627 00000663 4883C408                    add rsp, 8
   628 00000667 E953FDFFFF                  jmp pedir_casillero_destino
   629                                  destino_ok:
   630 0000066C C3                          ret    
   631                                  validar_movimiento_oficial:
   632                                  ;;falta resolver esto -> solo de a 1 en cualqeuir dir.
   633 0000066D 41BC00000000                mov r12,0
   634 00000673 B800000000                  mov rax,0
   635 00000678 8A0425[34000000]            mov al, [posx_ini]
   636 0000067F 8A2425[36000000]            mov ah, [posx_fin]
   637 00000686 28E0                        sub al,ah
   638                                  
   639 00000688 BA00000000                  mov rdx,0
   640 0000068D 8A1425[35000000]            mov dl, [posy_ini]
   641 00000694 8A3425[37000000]            mov dh, [posy_fin]
   642 0000069B 28F2                        sub dl,dh
   643                                  
   644 0000069D 3C00                        cmp al, 0
   645 0000069F 7410                        je validar_movimientos_oficial_horizontal ;;listo
   646 000006A1 3C01                        cmp al, 1
   647 000006A3 7428                        je validar_movimiento_simple_oficial_arriba_abajo ;;listo
   648 000006A5 3CFF                        cmp al,-1
   649 000006A7 7424                        je validar_movimiento_simple_oficial_arriba_abajo ;;listo
   650                                      
   651 000006A9 3C02                        cmp al, 2
   652 000006AB 7440                        je validar_movimiento_doble_oficial_superiores ;;voy a validar esto
   653 000006AD 3CFE                        cmp al,-2
   654 000006AF 7450                        je validar_movimiento_doble_oficial_inferiores ;;falta validar
   655                                      
   656                                  ;;esto valida OK movimientos simples y dobles horizontales (falta validar dobles horizontales)
   657                                  validar_movimientos_oficial_horizontal:
   658                                      ;;movimiento simple
   659 000006B1 80FA01                      cmp dl, 1
   660 000006B4 0F84DE000000                je movimiento_oficial_ok
   661 000006BA 80FAFF                      cmp dl,-1
   662 000006BD 0F84D5000000                je movimiento_oficial_ok
   663                                      ;;movimiento doble (comio)
   664 000006C3 80FA02                      cmp dl, 2
   665 000006C6 744D                        je validar_movimiento_doble_izquierda ;; aca falta validar que haya X en el medio
   666 000006C8 80FAFE                      cmp dl,-2
   667 000006CB 744C                        je validar_movimiento_doble_derecha ;; aca falta validar que haya X en el medio
   668                                  ;funcion ready (no necesita nada mas)
   669                                  validar_movimiento_simple_oficial_arriba_abajo:
   670                                      ;;si se movio 1 en x, solo puede ser movimiento simple
   671 000006CD 80FA01                      cmp dl, 1
   672 000006D0 0F84C2000000                je movimiento_oficial_ok
   673 000006D6 80FAFF                      cmp dl,-1
   674 000006D9 0F84B9000000                je movimiento_oficial_ok
   675 000006DF 80FA00                      cmp dl, 0
   676 000006E2 0F84B0000000                je movimiento_oficial_ok
   677 000006E8 E924010000                  jmp movimiento_oficial_invalido
   678                                  
   679                                  ;;movimientos dobles!
   680                                  validar_movimiento_doble_oficial_superiores:
   681 000006ED 80FA02                      cmp dl, 2
   682 000006F0 742B                        je validar_movimiento_doble_izquierda_superior
   683 000006F2 80FAFE                      cmp dl,-2
   684 000006F5 7430                        je validar_movimiento_doble_derecha_superior
   685 000006F7 80FA00                      cmp dl, 0
   686 000006FA 7427                        je validar_movimiento_doble_superior
   687 000006FC E910010000                  jmp movimiento_oficial_invalido
   688                                  
   689                                  validar_movimiento_doble_oficial_inferiores:
   690 00000701 80FA02                      cmp dl, 2
   691 00000704 7427                        je validar_movimiento_doble_izquierda_inferior
   692 00000706 80FAFE                      cmp dl,-2
   693 00000709 742C                        je validar_movimiento_doble_derecha_inferior
   694 0000070B 80FA00                      cmp dl, 0
   695 0000070E 7423                        je validar_movimiento_doble_inferior
   696 00000710 E9FC000000                  jmp movimiento_oficial_invalido
   697                                      
   698                                  ;;tengo que validar que haya una X en los movimientos dobles
   699                                  ;;voy a setear una posicion posx - posy para buscar elemento en la matriz
   700                                  ;;si hay una X efectivamente habia un soldado -> eliminar soldado -> movimiento ok!
   701                                  ;;else invalido.
   702                                  
   703                                  ;;hasta este momento en ah y dh estan los valores x y destino respectivamente
   704                                  validar_movimiento_doble_izquierda:
   705 00000715 FEC6                        inc dh
   706 00000717 EB24                        jmp validar_habia_soldado_en_movimiento_doble
   707                                  validar_movimiento_doble_derecha:
   708 00000719 FECE                        dec dh
   709 0000071B EB20                        jmp validar_habia_soldado_en_movimiento_doble
   710                                  validar_movimiento_doble_izquierda_superior:
   711 0000071D FEC6                        inc dh
   712 0000071F FEC4                        inc ah
   713 00000721 EB1A                        jmp validar_habia_soldado_en_movimiento_doble
   714                                  validar_movimiento_doble_superior:
   715 00000723 FEC4                        inc ah
   716 00000725 EB16                        jmp validar_habia_soldado_en_movimiento_doble
   717                                  validar_movimiento_doble_derecha_superior:
   718 00000727 FECE                        dec dh
   719 00000729 FEC4                        inc ah
   720 0000072B EB10                        jmp validar_habia_soldado_en_movimiento_doble
   721                                  validar_movimiento_doble_izquierda_inferior:
   722 0000072D FEC6                        inc dh
   723 0000072F FECC                        dec ah
   724 00000731 EB0A                        jmp validar_habia_soldado_en_movimiento_doble
   725                                  validar_movimiento_doble_inferior:
   726 00000733 FECC                        dec ah
   727 00000735 EB06                        jmp validar_habia_soldado_en_movimiento_doble
   728                                  validar_movimiento_doble_derecha_inferior:
   729 00000737 FECE                        dec dh
   730 00000739 FECC                        dec ah
   731 0000073B EB00                        jmp validar_habia_soldado_en_movimiento_doble
   732                                  
   733                                  
   734                                  ;;falta estar seguro de lo que hago aca. (validar X e Y..)
   735                                  validar_habia_soldado_en_movimiento_doble:
   736                                      
   737 0000073D 4829DB                      sub rbx, rbx
   738 00000740 88E3                        mov bl, ah      
   739 00000742 4829C0                      sub rax, rax      
   740 00000745 88D8                        mov al, bl
   741                                  
   742 00000747 4829DB                      sub rbx, rbx
   743 0000074A 88F3                        mov bl, dh
   744                                                  
   745 0000074C 4829C9                      sub rcx, rcx
   746 0000074F 4829D2                      sub rdx, rdx
   747 00000752 4D29C0                      sub r8, r8
   748 00000755 4D29D2                      sub r10, r10
   749                                      
   750                                   
   751 00000758 41B809000000                mov r8, cantidadFilas
   752 0000075E 49F7E8                      imul r8
   753 00000761 4801C1                      add rcx,rax
   754                                      
   755 00000764 88D8                        mov al, bl
   756 00000766 41B801000000                mov r8, longitudElemento 
   757 0000076C 49F7E8                      imul r8
   758 0000076F 4801C1                      add rcx,rax
   759                                      
   760 00000772 4829DB                      sub rbx, rbx   
   761 00000775 48BB-                       mov rbx,matriz 
   761 00000777 [B401000000000000] 
   762 0000077F 4801CB                      add rbx,rcx ;me posicione en la matriz
   763                                  
   764 00000782 4C8B13                      mov r10, [rbx] ;guardo un elemento
   765 00000785 4180FA58                    cmp r10b, 'X'
   766 00000789 7405                        je oficial_realizo_captura
   767 0000078B E981000000                  jmp movimiento_oficial_invalido
   768                                  
   769                                  oficial_realizo_captura:
   770 00000790 41BF01000000                mov r15, 1
   771 00000796 EB00                        jmp movimiento_oficial_ok
   772                                  
   773                                  ;;fin;; validaciones terminan en estas 2 funciones.
   774                                  movimiento_oficial_ok:
   775                                      
   776 00000798 4C8B4B01                    mov r9, [rbx+1] ;guardo en r9 lo que le sigue de matriz posterior al elemento a actualizar
   777 0000079C 41B820000000                mov r8, " " ; lo muevo a un reg para darle (y estar seguro de su) longitud
   778 000007A2 4C8903                      mov [rbx],r8 ;muevo el valor(de igual longitud). muevo a la posicion de la matriz a actualizar
   779                                      
   780                                      ;despues de agregar el nuevo valor, agregarle el resto de la matriz que estaba antes.
   781 000007A5 4C894B01                    mov [rbx+1],r9
   782 000007A9 41BC00000000                mov r12,0 ;si r12=0, movimiento OK
   783                                  ;si se desentendio borrar el oficial que se movio.
   784 000007AF 4D01EF                      add r15, r13
   785 000007B2 4983FF01                    cmp r15, 1
   786 000007B6 7401                        je borrar_oficial
   787                                      ;else termina turno oficiales
   788                                  termina_turno_oficiales:
   789 000007B8 C3                          ret
   790                                  borrar_oficial:
   791                                  ;voy a la posicion destino y borro el "O"
   792 000007B9 4829C9                      sub rcx, rcx
   793 000007BC 4829C0                      sub rax, rax
   794 000007BF 4829DB                      sub rbx, rbx
   795 000007C2 4D29D2                      sub r10, r10
   796 000007C5 8A0425[36000000]            mov al,[posx_fin] ;guardo el valor de la fila, en AL(8bits) 
   797                                                      ;ya que posx es db (byte= 8bits) sino guarda cualquier cosa
   798                                  ;    sub rax,1 -> no es necesaria la resta ya que la matriz empieza en 1,1
   799 000007CC 41B809000000                mov r8, cantidadFilas
   800 000007D2 49F7E8                      imul r8   ;me desplazo en la fila
   801 000007D5 4801C1                      add rcx,rax
   802                                      
   803 000007D8 8A0425[37000000]            mov al,[posy_fin] ;guardo el valor de la col,
   804                                  ;    sub rax,1
   805 000007DF 41B801000000                mov r8, longitudElemento ;guardo en r8 para darle longitud y poder multiplicar usando imul
   806 000007E5 49F7E8                      imul r8 ;me desplazo en la columna
   807 000007E8 4801C1                      add rcx,rax ;sumo los desplazamientos
   808                                      
   809                                      
   810 000007EB 48BB-                       mov rbx,matriz ;pongo el pto al inicio de la matriz
   810 000007ED [B401000000000000] 
   811 000007F5 4801CB                      add rbx,rcx ;me posicione en la matriz
   812                                  
   813 000007F8 4C8B13                      mov r10, [rbx] ;guardo un elemento
   814 000007FB 4C8B4B01                    mov r9, [rbx+1] ;guardo en r9 lo que le sigue de matriz posterior al elemento a actualizar
   815 000007FF 41B859000000                mov r8, "Y" ; lo muevo a un reg para darle (y estar seguro de su) longitud
   816 00000805 4C8903                      mov [rbx],r8 ;muevo el valor(de igual longitud). muevo a la posicion de la matriz a actualizar
   817                                      
   818                                      ;despues de agregar el nuevo valor, agregarle el resto de la matriz que estaba antes.
   819 00000808 4C894B01                    mov [rbx+1],r9
   820                                      
   821 0000080C 49FFCE                      dec r14 ;descuento un oficial
   822 0000080F EBA7                        jmp termina_turno_oficiales
   823                                  
   824                                  movimiento_oficial_invalido:
   825 00000811 48BF-                       mov rdi,msj_movimiento_oficial_invalido
   825 00000813 [8D00000000000000] 
   826 0000081B 4883EC08                    sub rsp, 8
   827 0000081F E8(00000000)                call printf
   828 00000824 4883C408                    add rsp,8
   829                                      
   830 00000828 41BC01000000                mov r12,1
   831 0000082E C3                          ret
   832                                  
   833                                  movimiento_soldado_invalido:
   834 0000082F 4889E0                      mov rax, rsp
   835 00000832 4883E00F                    and rax, 15
   836 00000836 7404                        je no_restar_rsp
   837 00000838 4883EC08                    sub rsp, 8
   838                                  no_restar_rsp:
   839 0000083C 48BF-                       mov rdi,msj_movimiento_soldado_invalido
   839 0000083E [BF00000000000000] 
   840 00000846 E8(00000000)                call printf
   841 0000084B 4883C408                    add rsp,8
   842 0000084F E9CDF7FFFF                  jmp pedir_movimiento
   843                                  
   844                                  movimiento_soldado_valido:
   845 00000854 41BF00000000                mov r15, 0 ;reseteo r15
   846 0000085A E805000000                  call validar_si_oficial_puede_comer_en_el_proximo_turno
   847 0000085F E99EF9FFFF                  jmp prox_turno
   848                                  
   849                                  validar_si_oficial_puede_comer_en_el_proximo_turno:
   850                                      ;encontrar oficial_1 (solo con el desplazamiento)
   851 00000864 4829C9                      sub rcx, rcx
   852 00000867 4829C0                      sub rax, rax
   853 0000086A 4829DB                      sub rbx, rbx
   854 0000086D 4D29D2                      sub r10, r10
   855                                      
   856 00000870 48BB-                       mov rbx,matriz ;pongo el pto al inicio de la matriz
   856 00000872 [B401000000000000] 
   857                                  actualizo_indice:
   858 0000087A 4C8B13                      mov r10, [rbx] ;guardo el oficial_1
   859 0000087D 4180FA4F                    cmp r10b, 'O'
   860 00000881 7405                        je revisar_si_oficial_puede_comer
   861 00000883 48FFC3                      inc rbx
   862 00000886 EBF2                        jmp actualizo_indice
   863                                  
   864                                  
   865                                  ;;;;;;;;aca viene lo bueno
   866                                  revisar_si_oficial_puede_comer:
   867                                      ;tengo en rbx la matriz en el indice del soldado.
   868                                  revisar_celda_derecha:
   869 00000888 4C8B5301                    mov r10, [rbx+1]; +1 = a la derecha de la posicion actual
   870 0000088C 4180FA58                    cmp r10b, 'X'
   871 00000890 7402                        je revisar_captura_derecha
   872 00000892 EB0E                        jmp revisar_celda_abajo_derecha
   873                                  revisar_captura_derecha:
   874 00000894 4C8B5302                    mov r10, [rbx+2] ;+2 = a la derecha 2posiciones de la posicion actual
   875 00000898 4180FA20                    cmp r10b, ' '
   876 0000089C 0F849E000000                je oficiales_pueden_comer
   877                                  
   878                                  revisar_celda_abajo_derecha:
   879 000008A2 4C8B530A                    mov r10, [rbx+10]; +10 = a la derecha abajo de la posicion actual
   880 000008A6 4180FA58                    cmp r10b, 'X'
   881 000008AA 7402                        je revisar_captura_abajo_derecha
   882 000008AC EB0E                        jmp revisar_celda_abajo
   883                                  revisar_captura_abajo_derecha:
   884 000008AE 4C8B5314                    mov r10, [rbx+20] ;+2 = a la derecha abajo 2posiciones de la posicion actual
   885 000008B2 4180FA20                    cmp r10b, ' '
   886 000008B6 0F8484000000                je oficiales_pueden_comer
   887                                  
   888                                  revisar_celda_abajo:
   889 000008BC 4C8B5309                    mov r10, [rbx+9]; +1 = abajo de la posicion actual
   890 000008C0 4180FA58                    cmp r10b, 'X'
   891 000008C4 7402                        je revisar_captura_abajo
   892 000008C6 EB0A                        jmp revisar_celda_abajo_izquierda
   893                                  revisar_captura_abajo:
   894 000008C8 4C8B5312                    mov r10, [rbx+18] ;+2 = abajo 2posiciones de la posicion actual
   895 000008CC 4180FA20                    cmp r10b, ' '
   896 000008D0 746E                        je oficiales_pueden_comer
   897                                  
   898                                  revisar_celda_abajo_izquierda:
   899 000008D2 4C8B5308                    mov r10, [rbx+8]
   900 000008D6 4180FA58                    cmp r10b, 'X'
   901 000008DA 7402                        je revisar_captura_abajo_izquierda
   902 000008DC EB0A                        jmp revisar_celda_izquierda
   903                                  revisar_captura_abajo_izquierda:
   904 000008DE 4C8B5310                    mov r10, [rbx+16]
   905 000008E2 4180FA20                    cmp r10b, ' '
   906 000008E6 7458                        je oficiales_pueden_comer
   907                                  
   908                                  revisar_celda_izquierda:
   909 000008E8 4C8B53FF                    mov r10, [rbx-1]
   910 000008EC 4180FA58                    cmp r10b, 'X'
   911 000008F0 7402                        je revisar_captura_izquierda
   912 000008F2 EB0A                        jmp revisar_celda_arriba_izquierda
   913                                  revisar_captura_izquierda:
   914 000008F4 4C8B53FE                    mov r10, [rbx-2]
   915 000008F8 4180FA20                    cmp r10b, ' '
   916 000008FC 7442                        je oficiales_pueden_comer
   917                                  
   918                                  revisar_celda_arriba_izquierda:
   919 000008FE 4C8B53F6                    mov r10, [rbx-10]
   920 00000902 4180FA58                    cmp r10b, 'X'
   921 00000906 7402                        je revisar_captura_arriba_izquierda
   922 00000908 EB0A                        jmp revisar_celda_arriba
   923                                  revisar_captura_arriba_izquierda:
   924 0000090A 4C8B53EC                    mov r10, [rbx-20]
   925 0000090E 4180FA20                    cmp r10b, ' '
   926 00000912 742C                        je oficiales_pueden_comer
   927                                  
   928                                  revisar_celda_arriba:
   929 00000914 4C8B53F7                    mov r10, [rbx-9]
   930 00000918 4180FA58                    cmp r10b, 'X'
   931 0000091C 7402                        je revisar_captura_arriba
   932 0000091E EB0A                        jmp revisar_celda_arriba_derecha
   933                                  revisar_captura_arriba:
   934 00000920 4C8B53EE                    mov r10, [rbx-18]
   935 00000924 4180FA20                    cmp r10b, ' '
   936 00000928 7416                        je oficiales_pueden_comer
   937                                  
   938                                  revisar_celda_arriba_derecha:
   939 0000092A 4C8B53F8                    mov r10, [rbx-8]
   940 0000092E 4180FA58                    cmp r10b, 'X'
   941 00000932 7402                        je revisar_captura_arriba_derecha
   942 00000934 EB11                        jmp oficiales_no_pueden_comer ;fin de validaciones
   943                                  revisar_captura_arriba_derecha:
   944 00000936 4C8B53F0                    mov r10, [rbx-16]
   945 0000093A 4180FA20                    cmp r10b, ' '
   946 0000093E 7400                        je oficiales_pueden_comer
   947                                  
   948                                  ;;;;;;;;aca termina lo bueno
   949                                  oficiales_pueden_comer:
   950 00000940 41BD01000000                mov r13, 1 ;se resetea siempre antes que jueguen oficiales
   951 00000946 C3                          ret
   952                                  oficiales_no_pueden_comer:
   953 00000947 41BD00000000                mov r13, 0 ;se resetea siempre antes que jueguen oficiales
   954 0000094D C3                          ret
   955                                  
   956                                  verificar_ganador:
   957 0000094E 4983FE00                    cmp r14, 0
   958 00000952 0F8491000000                je ganaron_soldados_por_falta_oficiales
   959                                  verificar_invasion:
   960 00000958 4829C9                      sub rcx, rcx
   961 0000095B 4829C0                      sub rax, rax
   962 0000095E 4829DB                      sub rbx, rbx
   963 00000961 4D29D2                      sub r10, r10
   964 00000964 B005                        mov al, 5
   965 00000966 41B809000000                mov r8, cantidadFilas
   966 0000096C 49F7E8                      imul r8
   967 0000096F 4801C1                      add rcx,rax
   968                                      
   969 00000972 B003                        mov al, 3
   970 00000974 41B801000000                mov r8, longitudElemento 
   971 0000097A 49F7E8                      imul r8
   972 0000097D 4801C1                      add rcx,rax
   973                                      
   974 00000980 48BB-                       mov rbx,matriz 
   974 00000982 [B401000000000000] 
   975 0000098A 4801CB                      add rbx,rcx ;me posicione en la matriz
   976                                  
   977                                  ;fila_5_fortaleza
   978 0000098D 4C8B13                      mov r10, [rbx] ;guardo un elemento
   979 00000990 4180FA58                    cmp r10b, 'X'
   980 00000994 7552                        jne no_invadieron_la_fortaleza
   981 00000996 4C8B5301                    mov r10, [rbx+1] ;guardo un elemento
   982 0000099A 4180FA58                    cmp r10b, 'X'
   983 0000099E 7548                        jne no_invadieron_la_fortaleza
   984 000009A0 4C8B5302                    mov r10, [rbx+2] ;guardo un elemento
   985 000009A4 4180FA58                    cmp r10b, 'X'
   986 000009A8 753E                        jne no_invadieron_la_fortaleza
   987                                  ;fila_6_fortaleza
   988 000009AA 4C8B5309                    mov r10, [rbx+9] ;guardo un elemento
   989 000009AE 4180FA58                    cmp r10b, 'X'
   990 000009B2 7534                        jne no_invadieron_la_fortaleza
   991 000009B4 4C8B530A                    mov r10, [rbx+10] ;guardo un elemento
   992 000009B8 4180FA58                    cmp r10b, 'X'
   993 000009BC 752A                        jne no_invadieron_la_fortaleza
   994 000009BE 4C8B530B                    mov r10, [rbx+11] ;guardo un elemento
   995 000009C2 4180FA58                    cmp r10b, 'X'
   996 000009C6 7520                        jne no_invadieron_la_fortaleza
   997                                  ;fila_7_fortaleza
   998 000009C8 4C8B5312                    mov r10, [rbx+18] ;guardo un elemento
   999 000009CC 4180FA58                    cmp r10b, 'X'
  1000 000009D0 7516                        jne no_invadieron_la_fortaleza
  1001 000009D2 4C8B5313                    mov r10, [rbx+19] ;guardo un elemento
  1002 000009D6 4180FA58                    cmp r10b, 'X'
  1003 000009DA 750C                        jne no_invadieron_la_fortaleza
  1004 000009DC 4C8B5314                    mov r10, [rbx+20] ;guardo un elemento
  1005 000009E0 4180FA58                    cmp r10b, 'X'
  1006 000009E4 7502                        jne no_invadieron_la_fortaleza
  1007                                  
  1008 000009E6 EB1D                        jmp ganaron_soldados_por_invasion
  1009                                      
  1010                                  no_invadieron_la_fortaleza:
  1011 000009E8 C3                          ret
  1012                                  
  1013                                  ganaron_soldados_por_falta_oficiales:
  1014 000009E9 48BF-                       mov rdi,msj_ganaron_soldados_por_falta_oficiales
  1014 000009EB [F100000000000000] 
  1015 000009F3 4883EC08                    sub rsp, 8
  1016 000009F7 E8(00000000)                call printf
  1017 000009FC 4883C408                    add rsp,8
  1018 00000A00 E911F8FFFF                  jmp fin
  1019                                  
  1020                                  ganaron_soldados_por_invasion:
  1021 00000A05 48BF-                       mov rdi,msj_ganaron_soldados_por_invasion
  1021 00000A07 [3F01000000000000] 
  1022 00000A0F 4883EC08                    sub rsp, 8
  1023 00000A13 E8(00000000)                call printf
  1024 00000A18 4883C408                    add rsp,8
  1025 00000A1C E9F5F7FFFF                  jmp fin
